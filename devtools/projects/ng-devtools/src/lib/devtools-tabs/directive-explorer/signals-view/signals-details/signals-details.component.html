@let node = this.node();
@let isSignalNode = this.isSignalNode(node);
@let isGroupNode = this.isGroupNode(node);

<div class="header">
  @if (isSignalNode) {
    <button
      ng-button
      size="compact"
      class="action-btn"
      (click)="gotoSource.emit(node)"
      [disabled]="!node.debuggable"
    >
      <mat-icon> arrow_outward </mat-icon>
      View Source
    </button>
  }
  <button
    ng-button
    btnType="icon"
    class="close-btn"
    (click)="close.emit()"
    title="Close the details"
  >
    <mat-icon>close</mat-icon>
  </button>
</div>

<dl>
  @if (node.label) {
    <dt>Name:</dt>
    <dd class="node-name">{{node.label}}</dd>
  }
  <dt>Type:</dt>
  <dd>
    @if (isSignalNode) {
      <span [class]="TYPE_CLASS_MAP[node.kind]" class="type">{{node.kind}}</span>
    } @else if (isGroupNode) {
      <span [class]="TYPE_CLASS_MAP[node.groupType]" class="type"
        >{{ node.groupType }} (group)</span
      >
    }
  </dd>
  @if (isSignalNode) {
    <dt>Epoch:</dt>
    <dd>{{node.epoch}}</dd>
  }
</dl>

@if (isSignalNode && (node.kind === 'signal' || node.kind === 'computed')) {
  @let dataSource = this.dataSource();

  @if (node.preview.preview === 'undefined' || !dataSource) {
    <div class="value">undefined</div>
  } @else {
    <ng-signals-value-tree [dataSource]="dataSource" [treeControl]="treeControl()" />
  }
}
